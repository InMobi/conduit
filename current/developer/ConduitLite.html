<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2014-02-14 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Conduit - Overview</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20140214" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                Conduit
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2014-02-14</span>
                  &nbsp;| <span id="projectVersion">Version: 2.2.6-SNAPSHOT</span>
                      </div>
            <div class="xright">                    <a href=".././" title="Conduit">Conduit</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                          <h5>Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="../conduit-core/index.html" title="Conduit Core">Conduit Core</a>
            </li>
                  <li class="none">
                          <a href="../conduit-distcp/index.html" title="Conduit Distcp">Conduit Distcp</a>
            </li>
                  <li class="none">
                          <a href="../conduit-worker/index.html" title="Conduit Worker">Conduit Worker</a>
            </li>
                  <li class="none">
                          <a href="../conduit-dist/index.html" title="Conduit Distribution">Conduit Distribution</a>
            </li>
                  <li class="none">
                          <a href="../conduit-audit/index.html" title="Conduit Audit">Conduit Audit</a>
            </li>
                  <li class="none">
                          <a href="../conduit-visualization/index.html" title="Conduit Visualization">Conduit Visualization</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h3>Overview<a name="Overview"></a></h3>
<p>Conduit-lite refers to the conduit setup in cloud environments where typically low volume data streams are generated by producers. Hence hadoop cluster may not provide cost benefit. Instead Amazon S3 service is used to store data. S3 is designed to provide extremely high durability (upto 99.9 nines's). Also note that there is no Job Tracker to execute conduit-lite MR jobs. Instead these jobs are executed in the local runner.</p></div>
<div class="section">
<h3>Topology<a name="Topology"></a></h3>
<p>The recommended topology to setup conduit-lite in a cluster is:</p>
<p></p>
<ol style="list-style-type: decimal">
<li>Configure an instance of scribe agent to run locally on the same box as the message publisher. The publisher writes messages to the local scribe agent, thus providing high write throughput and isolation from any downstream failure. Scribe agent should be configured to write to scribe collector(s). The agent is capable of handling various downstream failure scenarios and ensure that there is no data-loss by spooling data to its local disk and periodically de-spooling.</li>
<li>Configure an instance of scribe collector(s), each running on a separate machine. The scribe collector should be configured to write to S3/S3N service, as mentioned in <a herf="./ConduitLite.html#Setup_on_S3_S3N">setup</a> below.</li>
<li>Conduit typically supports message sizes of ~2-3K. However it has been successfully used to send messages upto 10K size as well.</li></ol></div>
<div class="section">
<h3>Setup on S3/S3N<a name="Setup_on_S3S3N"></a></h3></div>
<div class="section">
<h4>Conduit-lite setup<a name="Conduit-lite_setup"></a></h4>
<p>The following link describes how to configure conduit-lite: <a href="./ConduitLiteSetup.html">Setup</a></p></div>
<div class="section">
<h4>Configuration for S3/S3N<a name="Configuration_for_S3S3N"></a></h4>
<p>The following link describes how to make S3/S3N specific configurations: <a href="./ConduitLiteConfig.html">Configuration changes for S3/S3N</a></p></div>
<div class="section">
<h4>Configure Access to users<a name="Configure_Access_to_users"></a></h4>
<p>The following link describes how to configure read only/write access to users in AWS: <span style="color: blue;"><a href="./ConduitLiteReadAccess.html">Give Access to users</a></span></p></div>
<div class="section">
<h4>Using S3NativeCopyMapper<a name="Using_S3NativeCopyMapper"></a></h4>
<p>The S3NativeCopyMapper class is used to do server side copy within the S3 buckets.The copy mapper reduces the need to stream the data from S3 bucket to EC2 client on which CopyMapper runs.</p>
<p>In order to use S3NativeCopyMapper within conduit lite configure the cluster in the conduit.xml to use copy mapper implemenation as following:</p>
<div class="source">
<pre>
  &lt;cluster name=&quot;&quot; hdfsurl=&quot;s3n:///&quot;
   jturl=&quot;&quot;
   jobqueuename=&quot;&quot;
   copyMapperClass = &quot;com.inmobi.conduit.local.S3NCopyMapper&quot;/&gt;

</pre></div>
<p>Please note that the S3NativeCopyMapper works with S3N filesystem.</p></div>
<div class="section">
<h3>Benchmarking<a name="Benchmarking"></a></h3>
<p>Here are the results of various benchmarking tests done on EC2 cluster:</p></div>
<div class="section">
<h4>Latency<a name="Latency"></a></h4>
<p>Notes:</p>
<p></p>
<ol style="list-style-type: decimal">
<li>The above test covers the scenario of scribe collector writing to S3 bucket and conduit local/merge/mirror stream services processing files in S3. Latency is calculated by different consumers that read data written by collector/local/merge/mirror stream writers.</li>
<li>Merge/mirror stream is configured across different regions.</li>
<li>This test finds the <b>mean latency</b> (average latency to read all messages). In general, the order of mean latency (for collector/local/merge/mirror) is <b>(&lt;1 min/3-4 min/4-5 min/5-6 min)</b>.</li>
<li>This test does not cover <b>percentile latency</b>. However it should be possible to find percentile latency by using conduit audit feature exposed through audit dashboard. Please refer to <a href="./ConduitVisualization.html">Conduit visualization</a> for more details.</li></ol></div>
<div class="section">
<h4>Throughput<a name="Throughput"></a></h4>
<p>A) Refer to <b>producer/agent/collector throughput</b>  <a href="../ConduitLitePerfromanceOnAWS.pdf"> results </a>.</p>
<p>Notes:</p>
<p></p>
<ol style="list-style-type: decimal">
<li>This test finds the maximum acceptable write throughput of producer/agent/collector that ensures steady state, i.e. no message loss at producer, or no spooling at agent/collector.</li>
<li>The observed throughput is highly dependent on the EC2 instance type used. In general, m1.medium instance runs into high load average/CPU %wa and gives inconsistent results when co-hosting publisher and scribe agent. At least <b>m1.large instance</b> is recommended.</li></ol></div>
<div class="section">
<h3>Capacity planning<a name="Capacity_planning"></a></h3>
<p>In order to perform capacity planning, you can use the throughput results described in the <a href="ConduitLite.html#Throughput">throughput</a> section above. The aim is to have a conduit-lite setup where the system is running in <b>steady state</b>, i.e. there is no message loss/spooling happening at either of publisher, agent or collector tiers.</p>
<p></p>
<ol style="list-style-type: decimal">
<li>In order to write total of 'N' MB/s through conduit-lite layer, <b>minimum collector nodes needed = N/(max collector write throughput)</b>. If more than 1 collector is needed, then you would need to configure a VIP layer between scribe agents and collectors.</li>
<li>The <strong>minimum (publisher + scribe agent) nodes needed = N/ (max agent write throughput) </strong>in steady state. Note that publisher message queue size/scribe agent settings needs to be configured appropriately.</li>
<li>Scribe agent and collector nodes need to have sufficient disk space available in order to spool/de-spool data in case of rate mismatch.</li></ol></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2014
                        <a href="https://github.com/InMobi">InMobi</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
