<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2014-02-14 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Conduit - Conduit Admin Script</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20140214" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                Conduit
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2014-02-14</span>
                  &nbsp;| <span id="projectVersion">Version: 2.2.6-SNAPSHOT</span>
                      </div>
            <div class="xright">                    <a href=".././" title="Conduit">Conduit</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                          <h5>Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="../conduit-core/index.html" title="Conduit Core">Conduit Core</a>
            </li>
                  <li class="none">
                          <a href="../conduit-distcp/index.html" title="Conduit Distcp">Conduit Distcp</a>
            </li>
                  <li class="none">
                          <a href="../conduit-worker/index.html" title="Conduit Worker">Conduit Worker</a>
            </li>
                  <li class="none">
                          <a href="../conduit-dist/index.html" title="Conduit Distribution">Conduit Distribution</a>
            </li>
                  <li class="none">
                          <a href="../conduit-audit/index.html" title="Conduit Audit">Conduit Audit</a>
            </li>
                  <li class="none">
                          <a href="../conduit-visualization/index.html" title="Conduit Visualization">Conduit Visualization</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2>Conduit Admin Script<a name="Conduit_Admin_Script"></a></h2></div>
<div class="section">
<h3>Overview<a name="Overview"></a></h3>
<p>Conduit provides a set of commands that allow user to perform various admin level actions. These commands are exposed via <b>conduit-utils.sh</b> script that is bundled as part of conduit deb package. All these commands work with conduit.xml as a mandatory input.</p></div>
<div class="section">
<h3>Admin Actions<a name="Admin_Actions"></a></h3></div>
<div class="section">
<h3>A)  Streams validation<a name="A__Streams_validation"></a></h3></div>
<div class="section">
<h4>Command syntax:<a name="Command_syntax:"></a></h4>
<div class="source">
<pre>
./conduit-utils.sh admin *-verify* [-stream (comma separated stream names)] [-mode (comma separated stream modes:
 {local,merge,mirror})] [-cluster (comma separated cluster names)] &lt;-start (YYYY/MM/DD/HH/mm) | -relstart (minutes from now)&gt;
 &lt;-stop (YYYY/MM/DD/HH/mm) | -relstop (minutes from now)&gt; [-numThreads (number of threads for parallel listing)]
 &lt;-conf (conduit.xml file path)&gt;

</pre></div></div>
<div class="section">
<h4>Overview:<a name="Overview:"></a></h4>
<p>This command performs validation of given stream(s) running in the given mode(s) on the given destination cluster(s) and reports any inconsistencies. The inconsistencies reported for each &lt;stream, mode, destination cluster&gt; are: finding missing paths between source and destination cluster, finding holes in source and destination clusters, finding duplicates in destination cluster (in case of merge mode).</p></div>
<div class="section">
<h4>Arguments:<a name="Arguments:"></a></h4>
<p><b>-stream</b>: comma separated stream names to validate; optional. If not given, all source streams will be derived from conduit.xml and considered as input.</p>
<p><b>-mode</b>: comma separated stream modes; optional. Supported values are: local,merge,mirror. If not given, all modes will be considered for each stream.</p>
<p><b>-cluster</b>: comma separated cluster names; optional. If not given, all clusters will be derived from conduit.xml and considered as input.</p>
<p><b>-start | - relstart</b>: start time of source cluster to consider; <b>mandatory</b>. Either provide absolute start time or provide relative start time from now (and not both).</p>
<p><b>-stop | - relstop</b>: stop time of source cluster to consider; <b>mandatory</b>. Either provide absolute stop time or provide relative stop time from now (and not both).</p>
<p><b>-numThreads</b>: number of threads to be used to perform parallel recursive listing of source/destination clusters in the given time range; optional. Default value is 100.</p>
<p><b>-conf</b>: the path containing conduit.xml; <b>mandatory</b>.</p></div>
<div class="section">
<h3>B) Fix any missing paths/holes<a name="B_Fix_any_missing_pathsholes"></a></h3></div>
<div class="section">
<h4>Command syntax:<a name="Command_syntax:"></a></h4>
<div class="source">
<pre>
./conduit-utils.sh admin *-fix*  &lt;-stream (stream name)&gt; &lt;-mode (stream mode: {local,merge,mirror})&gt; &lt;-cluster (cluster name)&gt;
 &lt;-start (YYYY/MM/DD/HH/mm)&gt; &lt;-stop (YYYY/MM/DD/HH/mm)&gt; [-numThreads (number of threads for parallel listing)]
 &lt;-conf (conduit.xml file path)&gt;

</pre></div></div>
<div class="section">
<h4>Overview:<a name="Overview:"></a></h4>
<p>This command finds and fixes any inconsistencies of the given stream running in the given mode on the given destination cluster. The inconsistencies fixed by this command are: copying all missing paths between source and destination cluster, fixing holes in the destination cluster (in case of merge mode).</p>
<p>If any hole is found in source cluster (in case of mirror mode), this command will throw an exception. User should first run the command on source cluster to fix its inconsistency and then re-run on destination cluster.</p>
<p><b>NOTE: THIS COMMAND NEEDS SHUTDOWN OF THE DATABUS WORKER RUNNING ON DESTINATION CLUSTER</b>. The reason is that this command will actually perform data movement by copying data from source cluster to destination cluster. This data movement is not synchronized with any conduit worker runnning at the same destination cluster, and hence they both may interfere with each other.</p>
<p>Also in production setup, this command should be run with the same user login ('conduit') as used to start conduit worker in production cluster.</p></div>
<div class="section">
<h4>Arguments:<a name="Arguments:"></a></h4>
<p><b>-stream</b>: stream name whose inconsistency is to be fixed; <b>mandatory</b>.</p>
<p><b>-mode</b>: stream mode; <b>mandatory</b>. Supported values are: local,merge,mirror.</p>
<p><b>-cluster</b>: cluster name where input stream is running in input mode; mandatory.</p>
<p><b>-start</b>: absolute start time of source cluster to consider; <b>mandatory</b>.</p>
<p><b>-stop</b>: absolute stop time of source cluster to consider; <b>mandatory</b>.</p>
<p><b>-numThreads</b>: number of threads to be used to perform parallel recursive listing of source/destination clusters in the given time range; optional. Default value is 100.</p>
<p><b>-conf</b>: the path containing conduit.xml; <b>mandatory</b>.</p></div>
<div class="section">
<h3>C) Create checkpoint for a stream<a name="C_Create_checkpoint_for_a_stream"></a></h3></div>
<div class="section">
<h4>Command syntax:<a name="Command_syntax:"></a></h4>
<div class="source">
<pre>
 ./conduit-utils.sh admin *-checkpoint* &lt;-stream (stream name)&gt; &lt;-destCluster (destination cluster)&gt; [-srcCluster (source cluster)]
 &lt;-date (YYYY/MM/DD/HH/mm)&gt; &lt;-conf (conduit.xml file path)&gt;

</pre></div></div>
<div class="section">
<h4>Overview:<a name="Overview:"></a></h4>
<p>This command creates checkpoint of the given stream on the given destination cluster corresponding to the given source cluster. The checkpoint input is taken in the above date format.</p></div>
<div class="section">
<h4>Arguments:<a name="Arguments:"></a></h4>
<p><b>-stream</b>: stream name whose checkpoint is to be created; <b>mandatory</b>.</p>
<p><b>-destCluster</b>: destination cluster where checkpoint will be created and stored; <b>mandatory</b>.</p>
<p><b>-srcCluster</b>: source cluster whose checkpoint is being written; <b>mandatory</b>.</p>
<p><b>-date</b>: the checkpoint value of source cluster; <b>mandatory</b>.</p>
<p><b>-conf</b>: the path containing conduit.xml; <b>mandatory</b>.</p></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2014
                        <a href="https://github.com/InMobi">InMobi</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
